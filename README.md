# vue-ssr
## 为什么使用ssr
- 单页应用spa首页加载缓慢，要等到下载完首屏js后才能渲染出html；
- seo不友好，搜索引擎的爬虫工具只能抓取首页模板html，并不会执行js去渲染完整的页面，所以获取的信息极少；

## ssr的解决办法
- 客户端发起请求，服务端使用本地js代码生成html发送给客户端（如同jsp等服务端渲染技术），再下载js并执行完，完成客户端的激活同步()，所以客户端不需要等待js下载完成再去渲染页面；
- 服务端和客户端都会生成编译后的代码，这意味着客户端仍可以做成spa单页应用，只有当用户刷新页面，在地址栏输入链接地址或点击使用原生href属性链接的a标签等情况下，客户端会向服务端请求渲染后的页面和重新请求所有js（已缓存的静态文件则不会去下载）执行，而这个过程类似于爬虫工具请求页面，所以即使客户端使用spa模式，爬虫工具还是能通过服务端获取到完整的html页面，这得益于服务端和客户端的代码是能够独立运行的，但要注意一点的是，页面刷新，vuex状态会丢失，它会重新混入服务端的vuex。

## ssr构建原理
- 在官网的构建例子中，可以看到，首先需要生成客户端代码（spa模式）和服务端代码（一个json文件，键值对，根据url请求找到对应的值生成html和js），两端代码同时打包，客户端需先打包完，热更新也是一样。
- 需要一个静态资源服务器（如koa等），当客户端发起请求，则根据url渲染出页面回送，在渲染前，如果有api异步请求则需要等待异步api请求完成，
客户端收到html，在下载完js后在进行客户端数据混合。
- 具体构建步骤原理 -> 传送门：[vue ssr指南](https://ssr.vuejs.org/zh/#什么是服务器端渲染-ssr-？). 

